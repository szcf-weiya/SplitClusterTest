[{"path":"https://hohoweiya.xyz/SplitClusterTest/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 SplitClusterTest authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/one-cell-type.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"One Cell Type","text":"","code":"sessionInfo() #> R version 4.1.3 (2022-03-10) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> attached base packages: #> [1] stats     graphics  grDevices datasets  utils     methods   base      #>  #> other attached packages: #> [1] future_1.69.0          SplitClusterTest_0.1.4 #>  #> loaded via a namespace (and not attached): #>   [1] copula_1.1-6                spatstat.univar_3.0-1       #>   [3] spam_2.11-0                 systemfonts_1.1.0           #>   [5] plyr_1.8.9                  igraph_2.1.1                #>   [7] lazyeval_0.2.2              sp_2.1-4                    #>   [9] splines_4.1.3               pspline_1.0-21              #>  [11] listenv_0.9.1               scattermore_1.2             #>  [13] GenomeInfoDb_1.30.1         ggplot2_3.5.1               #>  [15] digest_0.6.37               htmltools_0.5.8.1           #>  [17] fansi_1.0.6                 magrittr_2.0.3              #>  [19] tensor_1.5                  cluster_2.1.2               #>  [21] ROCR_1.0-11                 globals_0.18.0              #>  [23] matrixStats_1.4.1           stabledist_0.7-2            #>  [25] pkgdown_2.2.0               spatstat.sparse_3.1-0       #>  [27] colorspace_2.1-1            ggrepel_0.9.6               #>  [29] textshaping_0.4.0           xfun_0.56                   #>  [31] dplyr_1.1.4                 RCurl_1.98-1.16             #>  [33] jsonlite_1.8.9              progressr_0.14.0            #>  [35] spatstat.data_3.1-2         survival_3.2-13             #>  [37] zoo_1.8-12                  glue_1.8.0                  #>  [39] polyclip_1.10-7             gtable_0.3.5                #>  [41] zlibbioc_1.40.0             XVector_0.34.0              #>  [43] leiden_0.4.3.1              DelayedArray_0.20.0         #>  [45] future.apply_1.20.1         SingleCellExperiment_1.16.0 #>  [47] BiocGenerics_0.40.0         abind_1.4-8                 #>  [49] scales_1.3.0                mvtnorm_1.3-3               #>  [51] spatstat.random_3.3-2       miniUI_0.1.1.1              #>  [53] Rcpp_1.0.13                 viridisLite_0.4.2           #>  [55] xtable_1.8-4                reticulate_1.39.0           #>  [57] dotCall64_1.2               stats4_4.1.3                #>  [59] htmlwidgets_1.6.4           httr_1.4.7                  #>  [61] RColorBrewer_1.1-3          Seurat_4.4.0                #>  [63] ica_1.0-3                   pkgconfig_2.0.3             #>  [65] farver_2.1.2                sass_0.4.9                  #>  [67] uwot_0.2.2                  deldir_2.0-4                #>  [69] utf8_1.2.4                  tidyselect_1.2.1            #>  [71] rlang_1.1.4                 reshape2_1.4.4              #>  [73] later_1.3.2                 munsell_0.5.1               #>  [75] tools_4.1.3                 cachem_1.1.0                #>  [77] cli_3.6.3                   generics_0.1.3              #>  [79] ggridges_0.5.6              evaluate_1.0.1              #>  [81] stringr_1.5.1               fastmap_1.2.0               #>  [83] yaml_2.3.10                 ragg_1.5.0                  #>  [85] goftest_1.2-3               knitr_1.51                  #>  [87] fs_1.6.4                    fitdistrplus_1.2-1          #>  [89] purrr_1.0.2                 RANN_2.6.2                  #>  [91] pbapply_1.7-4               nlme_3.1-155                #>  [93] mime_0.12                   compiler_4.1.3              #>  [95] plotly_4.10.4               png_0.1-8                   #>  [97] spatstat.utils_3.1-0        tibble_3.2.1                #>  [99] pcaPP_2.0-5                 gsl_2.1-7                   #> [101] bslib_0.8.0                 stringi_1.8.4               #> [103] desc_1.4.3                  lattice_0.20-45             #> [105] Matrix_1.6-5                vctrs_0.6.5                 #> [107] pillar_1.9.0                lifecycle_1.0.4             #> [109] ADGofTest_0.3               BiocManager_1.30.25         #> [111] spatstat.geom_3.3-3         lmtest_0.9-40               #> [113] jquerylib_0.1.4             RcppAnnoy_0.0.22            #> [115] data.table_1.16.2           cowplot_1.1.3               #> [117] bitops_1.0-9                irlba_2.3.5.1               #> [119] httpuv_1.6.15               patchwork_1.3.0             #> [121] GenomicRanges_1.46.1        R6_2.5.1                    #> [123] promises_1.3.0              renv_1.0.10                 #> [125] KernSmooth_2.23-20          gridExtra_2.3               #> [127] IRanges_2.28.0              parallelly_1.46.1           #> [129] codetools_0.2-18            MASS_7.3-55                 #> [131] SummarizedExperiment_1.24.0 SeuratObject_5.0.2          #> [133] sctransform_0.4.1           S4Vectors_0.32.4            #> [135] GenomeInfoDbData_1.2.7      parallel_4.1.3              #> [137] grid_4.1.3                  tidyr_1.3.1                 #> [139] rmarkdown_2.30              MatrixGenerics_1.6.0        #> [141] Rtsne_0.17                  spatstat.explore_3.3-3      #> [143] numDeriv_2016.8-1.1         Biobase_2.54.0              #> [145] shiny_1.9.1"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-cell-types.html","id":"step-1-perform-testing-after-clustering-on-each-half-via-multiple-data-splitting","dir":"Articles","previous_headings":"","what":"Step 1: Perform Testing-after-Clustering on Each Half via (Multiple) Data Splitting","title":"Two Cell Types","text":"returns mirror statistics,  step, cutoff chosen control nominal False Discovery Rate (FDR) q = 0.05. Note histogram results first data splitting mss[[1]]. multiple data splitting, can aggregate results calculating inclusion rate gene, also calculate cutoff. , either DS MDS, can obtain estimation significant DE gene set. wrap second step. multiple data splitting (MDS), can aggregate results calculating inclusion rate gene determining new cutoff. allows us estimate set significant DE genes, whether using DS MDS. wrap process second step:","code":"mss = mds1(simdata_2ct$simu_sce,      M = 1, # times of data splitting      params1 = list(normalized_method = \"none\"), # parameters for the first half      params2 = list(normalized_method = \"none\")) # parameters for the second half #>  #> ===== Multiple Data Splitting:  1 / 1  ===== #>  #> ----- data splitting (1st half) ----- #>  #> ----- data splitting (2nd half) ---- hist(mss[[1]], breaks = 50) cutoff = calc_tau(mss[[1]], q = 0.05) abline(v = cutoff, lwd = 2, col = \"red\")"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-cell-types.html","id":"step-2--calculate-cutoff-and-estimate-the-selection-set","dir":"Articles","previous_headings":"","what":"Step 2. Calculate Cutoff and Estimate the Selection Set","title":"Two Cell Types","text":"can also evaluate accuracy","code":"sel = mds2(mss, q = 0.05) #> use the tie.method =  fair sel #>  [1] \"ENSG00000144713\" \"ENSG00000167526\" \"ENSG00000115268\" \"ENSG00000105640\" #>  [5] \"ENSG00000108298\" \"ENSG00000177600\" \"ENSG00000198242\" \"ENSG00000112306\" #>  [9] \"ENSG00000142676\" \"ENSG00000145425\" \"ENSG00000105372\" \"ENSG00000083845\" #> [13] \"ENSG00000166441\" \"ENSG00000122026\" \"ENSG00000143947\" \"ENSG00000205542\" #> [17] \"ENSG00000034510\" \"ENSG00000109475\" \"ENSG00000251562\" \"ENSG00000147604\" #> [21] \"ENSG00000138326\" \"ENSG00000140264\" \"ENSG00000102879\" \"ENSG00000116251\" #> [25] \"ENSG00000185201\" \"ENSG00000140319\" \"ENSG00000148908\" calc_acc(sel, truth) #>       fdr     power        f1  #> 0.2592593 1.0000000 0.8510638"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-cell-types.html","id":"a-whole-step","dir":"Articles","previous_headings":"","what":"A Whole Step","title":"Two Cell Types","text":"whole, two steps mds1 mds2 wrapped single function mds, can simply run following command obtain selection set. comparison, also check naive double-dipping method. accuracy ","code":"sel = mds(simdata_2ct$simu_sce,      q = 0.05,       M = 1,       params1 = list(normalized_method = \"none\"),       params2 = list(normalized_method = \"none\")) #>  #> ===== Multiple Data Splitting:  1 / 1  ===== #>  #> ----- data splitting (1st half) ----- #>  #> ----- data splitting (2nd half) ---- #> use the tie.method =  fair sel.dd = dd(simdata_2ct$simu_sce, params = list(normalized_method = \"none\"), q = 0.05, test.use = \"t\") calc_acc(sel.dd, truth) #>   fdr power    f1  #>     0     1     1"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-cell-types.html","id":"normalization","dir":"Articles","previous_headings":"","what":"Normalization","title":"Two Cell Types","text":"practice, account library size, normalization method needed. One suitable approach SCT transform.","code":"sel.sct = mds(simdata_2ct$simu_sce,      q = 0.05,       M = 1,       params1 = list(normalized_method = \"sct\"),       params2 = list(normalized_method = \"sct\")) #>  #> ===== Multiple Data Splitting:  1 / 1  ===== #>  #> ----- data splitting (1st half) ----- #>  #> ----- data splitting (2nd half) ---- #> use the tie.method =  fair sel.dd.sct = dd(simdata_2ct$simu_sce, params = list(normalized_method = \"sct\")) #> Warning: The following arguments are not used: norm.method sapply(list(ds = sel.sct, dd = sel.dd.sct), function(x) calc_acc(x, names(simdata_2ct$de_idx))) #>              ds        dd #> fdr   0.1304348 0.8245614 #> power 1.0000000 1.0000000 #> f1    0.9302326 0.2985075"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-cell-types.html","id":"whitening","dir":"Articles","previous_headings":"","what":"Whitening","title":"Two Cell Types","text":"recommend whitening strategy weak signal (highly) correlated data.","code":"sel = mds(simdata_2ct$simu_sce,      q = 0.05,       M = 1,       params1 = list(normalized_method = \"sct\", pca.whiten = TRUE),       params2 = list(normalized_method = \"sct\", pca.whiten = TRUE)) #>  #> ===== Multiple Data Splitting:  1 / 1  ===== #>  #> ----- data splitting (1st half) ----- #>  #> ----- data splitting (2nd half) ---- #> use the tie.method =  fair sel.dd = dd(simdata_2ct$simu_sce, params = list(normalized_method = \"sct\", pca.whiten = TRUE)) #> Warning: The following arguments are not used: norm.method sapply(list(ds = sel, dd = sel.dd), function(x) calc_acc(x, names(simdata_2ct$de_idx))) #>               ds        dd #> fdr   0.09090909 0.8290598 #> power 1.00000000 1.0000000 #> f1    0.95238095 0.2919708"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-cell-types.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Two Cell Types","text":"","code":"sessionInfo() #> R version 4.1.3 (2022-03-10) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> attached base packages: #> [1] stats     graphics  grDevices datasets  utils     methods   base      #>  #> other attached packages: #> [1] future_1.69.0          SplitClusterTest_0.1.4 #>  #> loaded via a namespace (and not attached): #>   [1] copula_1.1-6                spatstat.univar_3.0-1       #>   [3] spam_2.11-0                 systemfonts_1.1.0           #>   [5] plyr_1.8.9                  igraph_2.1.1                #>   [7] lazyeval_0.2.2              sp_2.1-4                    #>   [9] splines_4.1.3               pspline_1.0-21              #>  [11] listenv_0.9.1               scattermore_1.2             #>  [13] GenomeInfoDb_1.30.1         ggplot2_3.5.1               #>  [15] digest_0.6.37               htmltools_0.5.8.1           #>  [17] fansi_1.0.6                 magrittr_2.0.3              #>  [19] tensor_1.5                  cluster_2.1.2               #>  [21] ROCR_1.0-11                 globals_0.18.0              #>  [23] matrixStats_1.4.1           stabledist_0.7-2            #>  [25] pkgdown_2.2.0               spatstat.sparse_3.1-0       #>  [27] colorspace_2.1-1            ggrepel_0.9.6               #>  [29] textshaping_0.4.0           xfun_0.56                   #>  [31] dplyr_1.1.4                 RCurl_1.98-1.16             #>  [33] jsonlite_1.8.9              progressr_0.14.0            #>  [35] spatstat.data_3.1-2         survival_3.2-13             #>  [37] zoo_1.8-12                  glue_1.8.0                  #>  [39] polyclip_1.10-7             gtable_0.3.5                #>  [41] zlibbioc_1.40.0             XVector_0.34.0              #>  [43] leiden_0.4.3.1              DelayedArray_0.20.0         #>  [45] future.apply_1.20.1         SingleCellExperiment_1.16.0 #>  [47] BiocGenerics_0.40.0         abind_1.4-8                 #>  [49] scales_1.3.0                mvtnorm_1.3-3               #>  [51] spatstat.random_3.3-2       miniUI_0.1.1.1              #>  [53] Rcpp_1.0.13                 viridisLite_0.4.2           #>  [55] xtable_1.8-4                reticulate_1.39.0           #>  [57] dotCall64_1.2               stats4_4.1.3                #>  [59] htmlwidgets_1.6.4           httr_1.4.7                  #>  [61] RColorBrewer_1.1-3          Seurat_4.4.0                #>  [63] ica_1.0-3                   pkgconfig_2.0.3             #>  [65] farver_2.1.2                sass_0.4.9                  #>  [67] uwot_0.2.2                  deldir_2.0-4                #>  [69] utf8_1.2.4                  tidyselect_1.2.1            #>  [71] rlang_1.1.4                 reshape2_1.4.4              #>  [73] later_1.3.2                 munsell_0.5.1               #>  [75] tools_4.1.3                 cachem_1.1.0                #>  [77] cli_3.6.3                   generics_0.1.3              #>  [79] ggridges_0.5.6              evaluate_1.0.1              #>  [81] stringr_1.5.1               fastmap_1.2.0               #>  [83] yaml_2.3.10                 ragg_1.5.0                  #>  [85] goftest_1.2-3               knitr_1.51                  #>  [87] fs_1.6.4                    fitdistrplus_1.2-1          #>  [89] purrr_1.0.2                 RANN_2.6.2                  #>  [91] pbapply_1.7-4               nlme_3.1-155                #>  [93] mime_0.12                   compiler_4.1.3              #>  [95] plotly_4.10.4               png_0.1-8                   #>  [97] spatstat.utils_3.1-0        tibble_3.2.1                #>  [99] pcaPP_2.0-5                 gsl_2.1-7                   #> [101] bslib_0.8.0                 stringi_1.8.4               #> [103] desc_1.4.3                  lattice_0.20-45             #> [105] Matrix_1.6-5                vctrs_0.6.5                 #> [107] pillar_1.9.0                lifecycle_1.0.4             #> [109] ADGofTest_0.3               BiocManager_1.30.25         #> [111] spatstat.geom_3.3-3         lmtest_0.9-40               #> [113] jquerylib_0.1.4             RcppAnnoy_0.0.22            #> [115] data.table_1.16.2           cowplot_1.1.3               #> [117] bitops_1.0-9                irlba_2.3.5.1               #> [119] httpuv_1.6.15               patchwork_1.3.0             #> [121] GenomicRanges_1.46.1        R6_2.5.1                    #> [123] promises_1.3.0              renv_1.0.10                 #> [125] KernSmooth_2.23-20          gridExtra_2.3               #> [127] IRanges_2.28.0              parallelly_1.46.1           #> [129] codetools_0.2-18            MASS_7.3-55                 #> [131] SummarizedExperiment_1.24.0 SeuratObject_5.0.2          #> [133] sctransform_0.4.1           S4Vectors_0.32.4            #> [135] GenomeInfoDbData_1.2.7      parallel_4.1.3              #> [137] grid_4.1.3                  tidyr_1.3.1                 #> [139] rmarkdown_2.30              MatrixGenerics_1.6.0        #> [141] Rtsne_0.17                  spatstat.explore_3.3-3      #> [143] numDeriv_2016.8-1.1         Biobase_2.54.0              #> [145] shiny_1.9.1"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-gaussians.html","id":"generating-example-data","dir":"Articles","previous_headings":"","what":"Generating Example Data","title":"Two Gaussians","text":"Let‚Äôs create dataset using gen_data_normal function: example: Features 1 20 truly different clusters (delta = 3) Features 21 200 identically distributed (difference)","code":"data = gen_data_normal(n = 100, p = 200, prop = 0.1, delta = 3) X = data$X L = data$L"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-gaussians.html","id":"identifying-non-null-features-by-ds","dir":"Articles","previous_headings":"","what":"Identifying Non-null Features by DS","title":"Two Gaussians","text":"Now, let‚Äôs use DS procedure automatically identify features distinguish two clusters controlling false discovery rate (FDR) nominal level q = 0.2:","code":"set.seed(1) res = ds(X, q = 0.2) names(res$sel_set) #> NULL"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-gaussians.html","id":"evaluating-performance","dir":"Articles","previous_headings":"","what":"Evaluating Performance","title":"Two Gaussians","text":"know ground truth: features 1‚Äì20 truly different. Let‚Äôs measure accurately DS identified : gives us: Precision (1 - FDR): Proportion selected features truly different Recall (Power): Proportion true features correctly identified F1 score: Harmonic mean precision recall","code":"calc_acc(res$sel_set, 1:20) #>        fdr      power         f1  #> 0.04761905 1.00000000 0.97560976"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-gaussians.html","id":"visualizing-mirror-statistics","dir":"Articles","previous_headings":"","what":"Visualizing Mirror Statistics","title":"Two Gaussians","text":"DS uses mirror statistics distinguish signal noise. Let‚Äôs visualize distribution:  Interpretation: Mirror statistics large positive values suggest strong evidence differences clusters.","code":"hist(res$ms)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-gaussians.html","id":"a-more-robust-approach-mds","dir":"Articles","previous_headings":"","what":"A More Robust Approach: MDS","title":"Two Gaussians","text":"increased robustness variability, can use MDS (Multiple DS) procedure, aggregates results across multiple random splits: Check accuracy selected set","code":"set.seed(1) res = mds(X, M = 10, q = 0.2) #> use the tie.method =  fair calc_acc(res, 1:20) #>   fdr power    f1  #>     0     1     1"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-gaussians.html","id":"key-takeaways","dir":"Articles","previous_headings":"","what":"üí° Key Takeaways","title":"Two Gaussians","text":"DS provides straightforward approach feature selection FDR control MDS offers enhanced robustness aggregation across multiple random splits methods aim identify 20 truly different features controlling false discoveries histogram mirror statistics helps visualize separation signal noise","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-poissons.html","id":"setting-up-the-simulation","dir":"Articles","previous_headings":"","what":"Setting Up the Simulation","title":"Two Poissons","text":"Consider two distinct groups : 50 observations per group (100 total) 200 features following Poisson distributions 20 features (10%) showing genuine differences Correlation structure among features (modeled Gaussian copula) simulation parameters: delta: Magnitude difference groups rho: Correlation parameter controlling feature dependencies Ground Truth: Features 1‚Äì20 differ groups (delta = 5), features 21‚Äì200 identical. features share mild correlation (rho = 0.1).","code":"data = gen_data_pois(n = 100, p = 200, prop = 0.1, delta = 5, rho = 0.1) X = data$X L = data$L"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-poissons.html","id":"standard-ds-procedure","dir":"Articles","previous_headings":"","what":"Standard DS Procedure","title":"Two Poissons","text":"Let‚Äôs start basic DS approach identify differential features:","code":"set.seed(1) res = ds(X) res$sel_set #>  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19 #> [20]  20  28 107 143"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-poissons.html","id":"performance-evaluation","dir":"Articles","previous_headings":"","what":"Performance Evaluation","title":"Two Poissons","text":"can quantify well DS performed known truth: gives us: Precision (1 - FDR): Proportion selected features truly different Recall (Power): Proportion true features correctly identified F1 score: Harmonic mean precision recall","code":"calc_acc(res$sel_set, 1:20) #>       fdr     power        f1  #> 0.1304348 1.0000000 0.9302326"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-poissons.html","id":"visualizing-mirror-statistics","dir":"Articles","previous_headings":"","what":"Visualizing Mirror Statistics","title":"Two Poissons","text":"Understanding selection process can insightful:","code":"hist(res$ms)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/articles/two-poissons.html","id":"enhancing-robustness-with-mds","dir":"Articles","previous_headings":"","what":"Enhancing Robustness with MDS","title":"Two Poissons","text":"dealing correlated data, results can vary different data splits. Multiple DS (MDS) approach aggregates results across multiple random partitions stable feature selection: Check accuracy selected set","code":"set.seed(1) res = mds(X, M = 10) #> use the tie.method =  fair calc_acc(res, 1:20) #>   fdr power    f1  #>     0     1     1"},{"path":"https://hohoweiya.xyz/SplitClusterTest/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Lijun Wang. Author, maintainer. Yingxin Lin. Author.","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wang L, Lin Y (2026). SplitClusterTest: FDR Control via Data Splitting Testing--Clustering. R package version 0.1.4, https://github.com/szcf-weiya/SplitClusterTest.","code":"@Manual{,   title = {SplitClusterTest: FDR Control via Data Splitting for Testing-after-Clustering},   author = {Lijun Wang and Yingxin Lin},   year = {2026},   note = {R package version 0.1.4},   url = {https://github.com/szcf-weiya/SplitClusterTest}, }"},{"path":"https://hohoweiya.xyz/SplitClusterTest/index.html","id":"splitclustertest","dir":"","previous_headings":"","what":"FDR Control via Data Splitting for Testing-after-Clustering","title":"FDR Control via Data Splitting for Testing-after-Clustering","text":"R package Wang, L., Lin, Y., & Zhao, H. (2024). False Discovery Rate Control via Data Splitting Testing--Clustering (arXiv:2410.06451). arXiv. https://doi.org/10.48550/arXiv.2410.06451 proposed approach addresses double-dipping issue testing--clustering tasks, particularly single-cell data analysis, data used clustering (identify cell types) testing (select differentially expressed genes), can inflate false positives.   xkcd-style cartoon drawn help R package xkcd","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/index.html","id":"hammer_and_wrench-installation","dir":"","previous_headings":"","what":"üõ†Ô∏è Installation","title":"FDR Control via Data Splitting for Testing-after-Clustering","text":"single-cell data analysis, package depends Seurat. Since potential compatibility issue across different major versions Seurat. recommend Seurat v4, can installed via following command: can install package via potential compatibility issues, may need install Matrix version 1.6-5 older one.","code":"devtools::install_github(\"satijalab/seurat@v4.4.0\") devtools::install_github(\"szcf-weiya/SplitClusterTest\")"},{"path":"https://hohoweiya.xyz/SplitClusterTest/index.html","id":"arrow_right-see-also","dir":"","previous_headings":"","what":"‚û°Ô∏è See also","title":"FDR Control via Data Splitting for Testing-after-Clustering","text":"Julia implementation: https://github.com/szcf-weiya/SplitClusterTest.jl comparison data splitting data fission, check https://github.com/szcf-weiya/fission_vs_splitting.","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_acc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the accuracy (FDR, Power, F1 score) if truth is available ‚Äî calc_acc","title":"Calculate the accuracy (FDR, Power, F1 score) if truth is available ‚Äî calc_acc","text":"Calculate accuracy (FDR, Power, F1 score) truth available","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_acc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the accuracy (FDR, Power, F1 score) if truth is available ‚Äî calc_acc","text":"","code":"calc_acc(est, truth)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_acc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the accuracy (FDR, Power, F1 score) if truth is available ‚Äî calc_acc","text":"est selected relavent features truth vector true relevant features","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_acc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the accuracy (FDR, Power, F1 score) if truth is available ‚Äî calc_acc","text":"vector size three: fdr, power, F1 score","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_inc_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the inclusion rate ‚Äî calc_inc_rate","title":"Calculate the inclusion rate ‚Äî calc_inc_rate","text":"Calculate inclusion rate","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_inc_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the inclusion rate ‚Äî calc_inc_rate","text":"","code":"calc_inc_rate(mss, q = 0.05, sum_in_denom = TRUE)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_inc_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the inclusion rate ‚Äî calc_inc_rate","text":"mss list selection multiple data splitting q nominal FDR level sum_in_denom use modified inclusion rate (TRUE) original inclusion rate (FALSE)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_inc_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the inclusion rate ‚Äî calc_inc_rate","text":"inclusion rate feature","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_tau.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the cutoff the mirror statistics ‚Äî calc_tau","title":"Calculate the cutoff the mirror statistics ‚Äî calc_tau","text":"Calculate cutoff mirror statistics","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_tau.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the cutoff the mirror statistics ‚Äî calc_tau","text":"","code":"calc_tau(ms, q = 0.05)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_tau.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the cutoff the mirror statistics ‚Äî calc_tau","text":"ms Array mirror statistics q nominal FDR level (default: 0.05)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/calc_tau.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the cutoff the mirror statistics ‚Äî calc_tau","text":"cutoff","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/cluster_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the difference across two clusters for each feature ‚Äî cluster_diff","title":"Calculate the difference across two clusters for each feature ‚Äî cluster_diff","text":"Calculate difference across two clusters feature","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/cluster_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the difference across two clusters for each feature ‚Äî cluster_diff","text":"","code":"cluster_diff(x, cl)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/cluster_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the difference across two clusters for each feature ‚Äî cluster_diff","text":"x data matrix cl clustering label","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/cluster_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the difference across two clusters for each feature ‚Äî cluster_diff","text":"vector differences","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/dd.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper for the naive double-dipping method ‚Äî dd","title":"Wrapper for the naive double-dipping method ‚Äî dd","text":"Wrapper naive double-dipping method","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/dd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper for the naive double-dipping method ‚Äî dd","text":"","code":"dd(sce, params, test.use = \"t\", q = 0.05)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/dd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper for the naive double-dipping method ‚Äî dd","text":"sce SingleCellExperiment object params parameters passed clustering step perform_clustering test.use hypothesis testing DE test. Possible choices: t, wilcox, poisson, negbinom q nominal FDR level","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/dd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper for the naive double-dipping method ‚Äî dd","text":"vector selected significant features","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/debias_symmetry.html","id":null,"dir":"Reference","previous_headings":"","what":"Debias the statistics under the null for symmetry ‚Äî debias_symmetry","title":"Debias the statistics under the null for symmetry ‚Äî debias_symmetry","text":"Debias statistics null symmetry","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/debias_symmetry.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Debias the statistics under the null for symmetry ‚Äî debias_symmetry","text":"","code":"debias_symmetry(t, prop = 0.5)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/debias_symmetry.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Debias the statistics under the null for symmetry ‚Äî debias_symmetry","text":"t statistics debiased prop proportion used estimate mean/median statistics among null features","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/debias_symmetry.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Debias the statistics under the null for symmetry ‚Äî debias_symmetry","text":"debiased statistics","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.SingleCellExperiment.html","id":null,"dir":"Reference","previous_headings":"","what":"DS procedure for Seurat object ‚Äî ds.SingleCellExperiment","title":"DS procedure for Seurat object ‚Äî ds.SingleCellExperiment","text":"DS procedure Seurat object","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.SingleCellExperiment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DS procedure for Seurat object ‚Äî ds.SingleCellExperiment","text":"","code":"# S3 method for class 'SingleCellExperiment' ds(   sce,   params1 = NULL,   params2 = NULL,   seed = NA,   test.use = \"t\",   signal_measurement = \"tstat\",   test.from.raw = TRUE )"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.SingleCellExperiment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DS procedure for Seurat object ‚Äî ds.SingleCellExperiment","text":"sce SingleCellExperiment object params1 list parameters passed perform_clustering first half data splitting params2 list parameters passed perform_clustering second half data splitting. seed random seed reproducibility test.use hypothesis testing DE test. Possible choices: t, wilcox, poisson, negbinom signal_measurement signal measurement. Possible choices: test statistic tstat, signed p-value pval test..raw whether perform testing original data without normalization normalized data","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.SingleCellExperiment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DS procedure for Seurat object ‚Äî ds.SingleCellExperiment","text":"vector mirror statistics","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.html","id":null,"dir":"Reference","previous_headings":"","what":"DS procedure ‚Äî ds","title":"DS procedure ‚Äî ds","text":"DS procedure","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DS procedure ‚Äî ds","text":"","code":"ds(x, ...)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DS procedure ‚Äî ds","text":"x data matrix SingleCellExperiment object ... optional arguments","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"DS procedure for Matrix ‚Äî ds.matrix","title":"DS procedure for Matrix ‚Äî ds.matrix","text":"DS procedure Matrix","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DS procedure for Matrix ‚Äî ds.matrix","text":"","code":"# S3 method for class 'matrix' ds(x, kmeans_whiten = FALSE, Sigma = NULL, q = 0.05, debias = FALSE)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DS procedure for Matrix ‚Äî ds.matrix","text":"x data matrix kmeans_whiten whether perform whitening procedure kmean Sigma covariance matrix, null, estimate data q nominal FDR level debias whether debias (useful correlation high)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/ds.matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DS procedure for Matrix ‚Äî ds.matrix","text":"list selected set, mirror statistics, two signal measurements two halves","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/est.Sigma.html","id":null,"dir":"Reference","previous_headings":"","what":"estimate the covariance matrix (assuming there are two clusters) ‚Äî est.Sigma","title":"estimate the covariance matrix (assuming there are two clusters) ‚Äî est.Sigma","text":"estimate covariance matrix (assuming two clusters)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/est.Sigma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"estimate the covariance matrix (assuming there are two clusters) ‚Äî est.Sigma","text":"","code":"est.Sigma(x)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/est.Sigma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"estimate the covariance matrix (assuming there are two clusters) ‚Äî est.Sigma","text":"x data matrix","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/est.Sigma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"estimate the covariance matrix (assuming there are two clusters) ‚Äî est.Sigma","text":"estimate covariance matrix","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate simulation data with two gaussians ‚Äî gen_data_normal","title":"Generate simulation data with two gaussians ‚Äî gen_data_normal","text":"Generate simulation data two gaussians","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate simulation data with two gaussians ‚Äî gen_data_normal","text":"","code":"gen_data_normal(   n = 100,   p = 200,   delta = 3,   prop = 0.1,   rho = 0,   prop_cl1 = 0.5 )"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate simulation data with two gaussians ‚Äî gen_data_normal","text":"n sample size p number features delta signal strength prop proportion non-null features rho correlation parameter covariance matrix prop_cl1 proportion first cluster","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_pois.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Poisson data with latent structure ‚Äî gen_data_pois","title":"Generate Poisson data with latent structure ‚Äî gen_data_pois","text":"Generate Poisson data latent structure","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_pois.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Poisson data with latent structure ‚Äî gen_data_pois","text":"","code":"gen_data_pois(   n,   p,   delta = 3,   prop_imp = 0.1,   rho = 0.5,   block_size = 10,   type = \"discrete\",   sigma = 0 )"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_pois.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Poisson data with latent structure ‚Äî gen_data_pois","text":"n Number observations p Number features delta Effect size parameter prop_imp Proportion important features (default: 0.1) rho AR(1) correlation parameter (default: 0.5) block_size Size correlation blocks (default: 10) type Type latent variable: \"discrete\" (binary) \"continuous\" (default: \"discrete\") sigma Additional noise standard deviation (default: 0)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_pois.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Poisson data with latent structure ‚Äî gen_data_pois","text":"List containing X (data matrix) L (latent variable)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_pois.matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Matrix method for gen_data_pois (S3) ‚Äî gen_data_pois.matrix","title":"Matrix method for gen_data_pois (S3) ‚Äî gen_data_pois.matrix","text":"Matrix method gen_data_pois (S3)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_pois.matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Matrix method for gen_data_pois (S3) ‚Äî gen_data_pois.matrix","text":"","code":"gen_data_pois.matrix(Lambda, rho = 0.5, block_size = 10)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_pois.matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Matrix method for gen_data_pois (S3) ‚Äî gen_data_pois.matrix","text":"Lambda parameter matrix rho correlation parameter block_size copula correlation set block (mainly speed copula multivariate distribution)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/gen_data_pois.matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Matrix method for gen_data_pois (S3) ‚Äî gen_data_pois.matrix","text":"data matrix size Lambda","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.SingleCellExperiment.html","id":null,"dir":"Reference","previous_headings":"","what":"Multiple data splitting ‚Äî mds.SingleCellExperiment","title":"Multiple data splitting ‚Äî mds.SingleCellExperiment","text":"Multiple data splitting","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.SingleCellExperiment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multiple data splitting ‚Äî mds.SingleCellExperiment","text":"","code":"# S3 method for class 'SingleCellExperiment' mds(   sce,   ncores = 1,   M = 10,   q = 0.05,   tied.method = \"fair\",   sum_in_denom = TRUE,   ... )"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.SingleCellExperiment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multiple data splitting ‚Äî mds.SingleCellExperiment","text":"sce SingleCellExperiment object ncores larger 1, compute parallel ncores cores. M number data splitting q nominal FDR level (default: 0.05) tied.method method handling tied values. sum_in_denom calculating inclusion rate, use modified inclusion rate (TRUE) original inclusion rate (FALSE) ... arguments passed mds1 (mds1_parallel)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.SingleCellExperiment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multiple data splitting ‚Äî mds.SingleCellExperiment","text":"selected relevant features","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.html","id":null,"dir":"Reference","previous_headings":"","what":"MDS procedure ‚Äî mds","title":"MDS procedure ‚Äî mds","text":"MDS procedure","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MDS procedure ‚Äî mds","text":"","code":"mds(x, ...)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MDS procedure ‚Äî mds","text":"x data matrix SingleCellExperiment object ... optional arguments","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"MDS procedure for matrix ‚Äî mds.matrix","title":"MDS procedure for matrix ‚Äî mds.matrix","text":"MDS procedure matrix","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MDS procedure for matrix ‚Äî mds.matrix","text":"","code":"# S3 method for class 'matrix' mds(   x,   M = 10,   q = 0.05,   ncores = 1,   tied.method = \"fair\",   sum_in_denom = TRUE,   ... )"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MDS procedure for matrix ‚Äî mds.matrix","text":"x data matrix M number repetitions q nominal FDR level ncores number cores tied.method handling tied values determing cutoff sum_in_denom way calculating inclusion rate ... optional arguments passed ds.matrix","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds.matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MDS procedure for matrix ‚Äî mds.matrix","text":"list mirror statistics","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds1.html","id":null,"dir":"Reference","previous_headings":"","what":"Conduct multiple data splitting ‚Äî mds1","title":"Conduct multiple data splitting ‚Äî mds1","text":"Step 1 mds","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conduct multiple data splitting ‚Äî mds1","text":"","code":"mds1(sce, M = 2, ...)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conduct multiple data splitting ‚Äî mds1","text":"sce SingleCellExperiment object M number data splitting ... Arguments passed ds","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conduct multiple data splitting ‚Äî mds1","text":"list mirror statistics multiple data splitting","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds1_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Conduct multiple data splitting in parallel ‚Äî mds1_parallel","title":"Conduct multiple data splitting in parallel ‚Äî mds1_parallel","text":"Step 1 (parallel) mds","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds1_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conduct multiple data splitting in parallel ‚Äî mds1_parallel","text":"","code":"mds1_parallel(sce, M = 2, ncores = 10, ...)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds1_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conduct multiple data splitting in parallel ‚Äî mds1_parallel","text":"sce SingleCellExperiment object M number data splitting ncores number cores used parallel computing. better factor M. ... Arguments passed ds","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds1_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conduct multiple data splitting in parallel ‚Äî mds1_parallel","text":"list mirror statistics multiple data splitting","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds2.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate multiple data splitting results, and return a selection set ‚Äî mds2","title":"Aggregate multiple data splitting results, and return a selection set ‚Äî mds2","text":"Aggregate multiple data splitting results, return selection set","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate multiple data splitting results, and return a selection set ‚Äî mds2","text":"","code":"mds2(mss, q = 0.05, tied.method = \"fair\", sum_in_denom = TRUE)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate multiple data splitting results, and return a selection set ‚Äî mds2","text":"mss list, contains selections multiple data splitting procedures q nominal FDR level (default: 0.05) tied.method method handling tied values. sum_in_denom calculating inclusion rate, use modified inclusion rate (TRUE) original inclusion rate (FALSE)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mds2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate multiple data splitting results, and return a selection set ‚Äî mds2","text":"selected relevant features","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mirror_stat.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the mirror statistics ‚Äî mirror_stat","title":"Calculate the mirror statistics ‚Äî mirror_stat","text":"Calculate mirror statistics","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mirror_stat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the mirror statistics ‚Äî mirror_stat","text":"","code":"mirror_stat(d1, d2)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mirror_stat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the mirror statistics ‚Äî mirror_stat","text":"d1 signal measurement first half d2 signal measurement second half","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/mirror_stat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the mirror statistics ‚Äî mirror_stat","text":"vector mirror statistics","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myDiffTTest.html","id":null,"dir":"Reference","previous_headings":"","what":"Modified Seurat::DiffTTest by extending the output with statistics in addition to p-values ‚Äî myDiffTTest","title":"Modified Seurat::DiffTTest by extending the output with statistics in addition to p-values ‚Äî myDiffTTest","text":"Differential expression testing using Student's t-test","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myDiffTTest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Modified Seurat::DiffTTest by extending the output with statistics in addition to p-values ‚Äî myDiffTTest","text":"","code":"myDiffTTest(data.use, cells.1, cells.2, verbose = TRUE)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myDiffTTest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Modified Seurat::DiffTTest by extending the output with statistics in addition to p-values ‚Äî myDiffTTest","text":"data.use Data matrix test cells.1 Group 1 cells cells.2 Group 2 cells verbose Print progress bar","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myDiffTTest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Modified Seurat::DiffTTest by extending the output with statistics in addition to p-values ‚Äî myDiffTTest","text":"Identify differentially expressed genes two groups cells using Student's t-test","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myFindMarkers.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene expression markers of identity classes ‚Äî myFindMarkers","title":"Gene expression markers of identity classes ‚Äî myFindMarkers","text":"Wrapper Seurat::FindMarkers uses modified (extended) tests","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myFindMarkers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene expression markers of identity classes ‚Äî myFindMarkers","text":"","code":"myFindMarkers(object, ...)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myFindMarkers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gene expression markers of identity classes ‚Äî myFindMarkers","text":"object object ... Arguments passed methods specific DE methods","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myFindMarkers.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Gene expression markers of identity classes ‚Äî myFindMarkers","text":"Finds markers (differentially expressed genes) identity classes","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myGLMDETest.html","id":null,"dir":"Reference","previous_headings":"","what":"Modified Seurat::GLMDETest by extending the output with statistics in addition to p-values ‚Äî myGLMDETest","title":"Modified Seurat::GLMDETest by extending the output with statistics in addition to p-values ‚Äî myGLMDETest","text":"Modified Seurat::GLMDETest extending output statistics addition p-values","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myGLMDETest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Modified Seurat::GLMDETest by extending the output with statistics in addition to p-values ‚Äî myGLMDETest","text":"","code":"myGLMDETest(   data.use,   cells.1,   cells.2,   min.cells = 3,   latent.vars = NULL,   test.use = NULL,   verbose = TRUE )"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myGLMDETest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Modified Seurat::GLMDETest by extending the output with statistics in addition to p-values ‚Äî myGLMDETest","text":"data.use Data test cells.1 Group 1 cells cells.2 Group 2 cells min.cells Minimum number cells threshold latent.vars Latent variables test test.use parameterizes glm verbose Print progress bar","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myGLMDETest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Modified Seurat::GLMDETest by extending the output with statistics in addition to p-values ‚Äî myGLMDETest","text":"Returns p-value ranked matrix putative differentially expressed","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myWilcoxDETest.html","id":null,"dir":"Reference","previous_headings":"","what":"Modified Seurat::WilcoxDETest by extending the output with statistics in addition to p-values ‚Äî myWilcoxDETest","title":"Modified Seurat::WilcoxDETest by extending the output with statistics in addition to p-values ‚Äî myWilcoxDETest","text":"Modified Seurat::WilcoxDETest extending output statistics addition p-values","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myWilcoxDETest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Modified Seurat::WilcoxDETest by extending the output with statistics in addition to p-values ‚Äî myWilcoxDETest","text":"","code":"myWilcoxDETest(data.use, cells.1, cells.2, verbose = TRUE, ...)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myWilcoxDETest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Modified Seurat::WilcoxDETest by extending the output with statistics in addition to p-values ‚Äî myWilcoxDETest","text":"data.use Data matrix test cells.1 Group 1 cells cells.2 Group 2 cells verbose Print progress bar ... Extra parameters passed wilcox.test","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/myWilcoxDETest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Modified Seurat::WilcoxDETest by extending the output with statistics in addition to p-values ‚Äî myWilcoxDETest","text":"Returns p-value ranked matrix putative differentially expressed features","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/perform_clustering.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Clustering on a SingleCellExperiment object ‚Äî perform_clustering","title":"Perform Clustering on a SingleCellExperiment object ‚Äî perform_clustering","text":"Perform Clustering SingleCellExperiment object","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/perform_clustering.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Clustering on a SingleCellExperiment object ‚Äî perform_clustering","text":"","code":"perform_clustering(   sce,   ret_obj = FALSE,   normalized_method = \"LogNormalize\",   use.kmeans = FALSE,   kmeans.nstart = 1,   resolution = 0.5,   step = 0.05,   maxiter = 40,   louvain.nstart = 1,   louvain.alg = 1,   seed.cluster = 0,   kmeans.whiten = FALSE,   pca.whiten = FALSE,   npcs = 10,   k.param = 20,   test.use = \"t\",   test.from.raw = FALSE,   signal_measurement = \"tstat\",   verbose = FALSE )"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/perform_clustering.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Clustering on a SingleCellExperiment object ‚Äî perform_clustering","text":"sce SingleCellExperiment object ret_obj (Default: FALSE) whether return sce operation instead returning signal measurement normalized_method Normalization method. Possible choices: LogNormalize, sct, none use.kmeans TRUE, clustering using kmeans two clusters, otherwise, use Seurat::FindClusters need find resolution achieve two clusters kmeans.nstart nstart parameter kmeans resolution resolution parameter Seurat::FindClusters step find resolution desired number clusters, step size changing resolution parameter maxiter maximum iteration searching resolution two clusters louvain.nstart n.start parameter Seurat::FindClusters louvain.alg algorithm parameter Seurat::FindClusters seed.cluster random.seed parameter Seurat::FindClusters kmeans.whiten whether whitening kmeans clustering pca.whiten whether whitening PCA using Louvain algorithms npcs number PCs, parameter npcs used Seurat::RunPCA k.param parameter k.param used Seurat::FindNeighbors test.use hypothesis testing DE test. Possible choices: t, wilcox, poisson, negbinom test..raw whether perform testing original data without normalization normalized data signal_measurement signal measurement. Possible choices: test statistic tstat, signed p-value pval verbose whether print internal log messages","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/perform_clustering.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform Clustering on a SingleCellExperiment object ‚Äî perform_clustering","text":"vector signal measurements feature","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/rankSumTestWithCorrelation.html","id":null,"dir":"Reference","previous_headings":"","what":"Wilcoxon rank sum test (adapted from limma::rankSumTestWithCorrelation) ‚Äî rankSumTestWithCorrelation","title":"Wilcoxon rank sum test (adapted from limma::rankSumTestWithCorrelation) ‚Äî rankSumTestWithCorrelation","text":"Wilcoxon rank sum test (adapted limma::rankSumTestWithCorrelation)","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/rankSumTestWithCorrelation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wilcoxon rank sum test (adapted from limma::rankSumTestWithCorrelation) ‚Äî rankSumTestWithCorrelation","text":"","code":"rankSumTestWithCorrelation(index, statistics, correlation = 0, df = Inf)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/rankSumTestWithCorrelation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wilcoxon rank sum test (adapted from limma::rankSumTestWithCorrelation) ‚Äî rankSumTestWithCorrelation","text":"index index vector statistics[index] contains values statistic test group. statistics numeric vector giving values test statistic. correlation numeric scalar, average correlation cases test group.  Cases second group assumed independent first group. df degrees freedom correlation estimated.","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/rankSumTestWithCorrelation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wilcoxon rank sum test (adapted from limma::rankSumTestWithCorrelation) ‚Äî rankSumTestWithCorrelation","text":"Numeric vector length 4 containing left.tail right.tail p-values corresponding test statistics.","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/sel_inc_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform selection based on inclusion rate ‚Äî sel_inc_rate","title":"Perform selection based on inclusion rate ‚Äî sel_inc_rate","text":"Perform selection based inclusion rate","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/sel_inc_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform selection based on inclusion rate ‚Äî sel_inc_rate","text":"","code":"sel_inc_rate(inc_rate, q = 0.05, tied.method = \"fair\", tol = 1e-10)"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/sel_inc_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform selection based on inclusion rate ‚Äî sel_inc_rate","text":"inc_rate inclusion rate q nominal FDR level tied.method method handling tied values. Possible choices: include include tied rate exclude exclude tied rate fair (default) compromise way compare number tied values cutoff tol tolerance comparing equality two doubles","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/sel_inc_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform selection based on inclusion rate ‚Äî sel_inc_rate","text":"selected relevant features","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/simdata_1ct.html","id":null,"dir":"Reference","previous_headings":"","what":"Datasets Demo synthetic scRNA-seq data with one cell type based on DuoClustering2018::sce_full_Zhengmix4eq() ‚Äî simdata_1ct","title":"Datasets Demo synthetic scRNA-seq data with one cell type based on DuoClustering2018::sce_full_Zhengmix4eq() ‚Äî simdata_1ct","text":"Datasets Demo synthetic scRNA-seq data one cell type based DuoClustering2018::sce_full_Zhengmix4eq()","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/simdata_1ct.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Datasets Demo synthetic scRNA-seq data with one cell type based on DuoClustering2018::sce_full_Zhengmix4eq() ‚Äî simdata_1ct","text":"","code":"simdata_1ct"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/simdata_1ct.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Datasets Demo synthetic scRNA-seq data with one cell type based on DuoClustering2018::sce_full_Zhengmix4eq() ‚Äî simdata_1ct","text":"list simdata_1ct","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/simdata_2ct.html","id":null,"dir":"Reference","previous_headings":"","what":"Demo synthetic scRNA-seq data with two cell types based on DuoClustering2018::sce_full_Zhengmix4eq() ‚Äî simdata_2ct","title":"Demo synthetic scRNA-seq data with two cell types based on DuoClustering2018::sce_full_Zhengmix4eq() ‚Äî simdata_2ct","text":"Demo synthetic scRNA-seq data two cell types based DuoClustering2018::sce_full_Zhengmix4eq()","code":""},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/simdata_2ct.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Demo synthetic scRNA-seq data with two cell types based on DuoClustering2018::sce_full_Zhengmix4eq() ‚Äî simdata_2ct","text":"","code":"simdata_2ct"},{"path":"https://hohoweiya.xyz/SplitClusterTest/reference/simdata_2ct.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Demo synthetic scRNA-seq data with two cell types based on DuoClustering2018::sce_full_Zhengmix4eq() ‚Äî simdata_2ct","text":"list simdata_2ct","code":""}]
